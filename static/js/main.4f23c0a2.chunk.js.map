{"version":3,"sources":["deckgl-overlay.tsx","info-box.tsx","loader.tsx","utils.tsx","default-app-config.ts","app.tsx","report-web-vitals.ts","index.tsx"],"names":["DeckGLOverlay","props","useState","currentTime","setCurrentTime","id","animation","useEffect","window","requestAnimationFrame","animate","loopLength","timestamp","Date","now","timestampOffset","loopTime","loopTimeMinutes","cancelAnimationFrame","layers","trips","push","TripsLayer","data","getPath","d","segments","map","p","coordinates","getTimestamps","getColor","color","tagColor","nodes","highlightedNodes","length","forEach","n","find","hn","toLowerCase","highlightColor","opacity","widthMinPixels","trailLength","GeoJsonLayer","filled","getFillColor","node","properties","name","stroked","extruded","pointRadiusScale","getRadius","pickable","autoHighlight","onHover","handleOnHover","onClick","info","console","log","object","transitions","type","duration","easing","t","stiffness","damping","initialViewState","viewState","viewport","InfoBox","handleLoopTimeMinutes","handleTimestampOffset","handleTrailLength","handleDataChange","handleHighlightedNodes","reloadTrips","friendlyTime","setFriendlyTime","hideInfoBox","setHideInfoBox","percentThroughLoop","setPercentThroughLoop","updateBoxInfoLoopToggle","setUpdateBoxInfoLoopToggle","intervalId","setInterval","clearInterval","startDate","pTimestamp","pLoopTime","timeThroughLoop","pPercentThroughLoop","Math","floor","calculatedFriendlyTime","timeSinceStart","realTimeSinceStart","timeMultiplier","currentDate","getTime","minutes","String","getMinutes","getDate","getMonth","getFullYear","getHours","toFriendlyTime","getLoopTime","handleHighlightNodeChange","highlightedNodesCommaSep","pHighlightedNodes","value","highlightedNodesRemoved","handleInfoBoxVisibility","pHideInfoBox","dataSampleOptions","appConfig","dataSamples","idx","title","nodeListOptions","nodeList","highlightedNodesVl","selectDataEle","options","onChange","dataSampleOption","dataSampleIdx","friendlyName","className","min","max","event","newTimeThroughLoop","target","newTimestampOffset","onInput","loopTimeMinutesStr","pLoopTimeMinutes","parseFloat","newLoopTime","initialLoopTimeMinutes","trailLengthStr","pTrailLength","initialTrailLength","nodeLabelPlural","closeMenuOnSelect","isMulti","onMenuClose","placeholder","Loader","React","getUrlParam","URL","location","href","searchParams","get","getNumber","numStr","numNum","Number","isNaN","PARAM_DATA_IDX","PARAM_LOOPTIME","PARAM_TRAILLENGTH","PARAM_HIGHLIGHTNODES","updateKeyInString","keysString","sParam","sValue","sURLVariables","split","parameterUpdated","i","join","DEFAULT_APP_SETTINGS","colors","initialViewport","latitude","longitude","zoom","maxZoom","pitch","bearing","width","height","mapboxStyle","nodeLabel","getWindowSize","innerWidth","innerHeight","App","result","dataIdx","highlightNodes","Utils","knownUrlParams","setKnownUrlParams","appSettings","setAppSettings","setDataSampleIdx","setFriendlyName","setHighlightedNodes","setLoopLength","setLoopTimeMinutes","setNodeList","setNodes","popupInfo","setPopupInfo","setStartDate","setTimestampOffset","setTimeMultiplier","setTrailLength","setTrips","transitionDuration","transitionInterpolator","FlyToInterpolator","setViewport","handleWindowResize","prevViewport","addEventListener","fetch","method","headers","then","fetchResponse","status","json","pAppSettings","prevAppSettings","catch","error","removeEventListener","dataUrlIdx","prevKnownUrlParams","url","tripsUrl","response","pFriendlyName","pStartDate","startTimestamp","parse","pTimeMultiplier","pTrips","pLoopLength","loadTrips","nodeListUrl","sort","geoJsonUrl","loadGeoJsonNodes","initialPartialViewport","history","pushState","params","newStateStr","decodeURIComponent","search","substring","queryFilters","loader","popupEle","geometry","closeButton","closeOnClick","anchor","mapStyle","dragRotate","onViewportChange","pViewport","mapboxApiAccessToken","process","pDataSampleIdx","prevNodes","pTimestampOffset","prevTrips","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","mapboxgl","workerClass","require","default","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.4f23c0a2.chunk.js","sourcesContent":["import { useState, useEffect } from 'react';\nimport DeckGL, {GeoJsonLayer, TripsLayer} from 'deck.gl';\nimport {DeckglOverlayProps, Trip, Waypoint} from './data-interfaces';\nimport { RGBAColor, Position } from '@deck.gl/core';\nimport { Feature, Point } from 'geojson';\n\nconst DeckGLOverlay = (props: DeckglOverlayProps) => {\n\n  const [currentTime, setCurrentTime] = useState(0);\n  const [animation] = useState({id:0});\n\n  useEffect(() => {\n    const animate = () => {\n      if (props.loopLength != null) {\n        const timestamp = Date.now() - props.timestampOffset;\n        const loopTime = props.loopTimeMinutes * 60 * 1000; // in x * 1000, x is in seconds\n        setCurrentTime((timestamp % loopTime) * (props.loopLength / loopTime));\n      }\n      animation.id = window.requestAnimationFrame(animate);\n    }\n\n    animation.id = window.requestAnimationFrame(animate);\n    return () => window.cancelAnimationFrame(animation.id);\n  }, [animation, props.loopLength, props.timestampOffset, props.loopTimeMinutes]);\n\n  const getTripColor = (d: Trip) => {\n    let color = props.color;\n    const tagColor = d.color;\n    if (tagColor != null) {\n      color = tagColor;\n    }\n\n    if (d.nodes != null) {\n      if (props.highlightedNodes.length > 0) {\n        d.nodes.forEach((n: string) => {\n          if (props.highlightedNodes.find((hn: string) => n.toLowerCase() === hn.toLowerCase()) != null) {\n            color = props.highlightColor;\n          }\n        });\n      }\n    }\n\n    return color as RGBAColor;\n  }\n\n  const getNodeColor = (d: unknown) => {\n    let node = d as Feature<Point>;\n    let color = [0, 255, 178, 150];\n\n    if (props.highlightedNodes.length > 0\n      && node.properties?.name\n      && props.highlightedNodes.find((hn: string) => node.properties?.name.toLowerCase() === hn.toLowerCase()) != null) {\n        color = [255, 109, 245, 150];\n    }\n\n    return color as RGBAColor;\n  }\n\n  const getNodeRadius = (d: unknown) => {\n    let node = d as Feature<Point>;\n    if (props.highlightedNodes.length > 0\n      && node.properties?.name\n      && props.highlightedNodes.find((hn: string) => node.properties?.name.toLowerCase() === hn.toLowerCase()) != null) {\n        return 2;\n    }\n    return 0.4;\n  };\n\n  let layers = [];\n  \n  if (props.trips != null) {\n    layers.push(new TripsLayer({\n      id: 'trips',\n      data: props.trips,\n      getPath: (d: Trip) => d.segments.map((p: Waypoint) => p.coordinates as Position),\n      getTimestamps: (d: Trip) => d.segments.map((p: Waypoint) => p.timestamp),\n      getColor: getTripColor,\n      opacity: 0.3,\n      widthMinPixels: 2,\n      trailLength: props.trailLength,\n      currentTime\n    }));\n  }\n\n  if (props.nodes != null) {\n    layers.push(new GeoJsonLayer({\n      id: 'geojson-layer',\n      data: props.nodes,\n      filled: true,\n      getFillColor: getNodeColor,\n      stroked: true,\n      extruded: false,\n      pointRadiusScale: 100,\n      getRadius: getNodeRadius,\n      pickable: true,\n      autoHighlight: true,\n      highlightColor: [0, 255, 178, 250],\n      onHover: props.handleOnHover,\n      onClick: (info: any) => console.log(info.object.properties.name),\n      transitions: {\n        getFillColor: {\n          type: 'interpolation',\n          duration: 700,\n          easing: (t) => ((t *= 2) <= 1 ? t * t * t : (t -= 2) * t * t + 2) / 2,\n        },\n        getRadius: {\n          type: 'spring',\n          stiffness: 0.2,\n          damping: 0.3\n        }\n      }\n    }));\n  }\n\n  if (layers.length === 0) {\n    return null;\n  }\n\n  return (\n    <DeckGL\n      initialViewState={props.initialViewState}\n      viewState={props.viewport}\n      layers={layers}\n    />\n  );\n}\n\nexport default DeckGLOverlay;","import { useState, useEffect } from 'react';\nimport { DataSampleUrls, InfoBoxProps} from './data-interfaces';\nimport Select from 'react-select';\nimport './info-box.css';\nimport './select.css';\nimport { ValueType } from 'react-select/src/types';\n\nconst InfoBox = (props: InfoBoxProps) => {\n\n  const {handleLoopTimeMinutes, handleTimestampOffset, handleTrailLength, handleDataChange, handleHighlightedNodes, reloadTrips} = props;\n\n  const [friendlyTime, setFriendlyTime] = useState('');\n  const [hideInfoBox, setHideInfoBox] = useState(false);\n  const [percentThroughLoop, setPercentThroughLoop] = useState(0);\n  const [updateBoxInfoLoopToggle, setUpdateBoxInfoLoopToggle] = useState(false);\n\n  useEffect(() => {\n    const intervalId = setInterval(() => setUpdateBoxInfoLoopToggle(updateBoxInfoLoopToggle => !updateBoxInfoLoopToggle), 1000);\n    return () => {\n      clearInterval(intervalId);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    // Update Box Info\n\n    const toFriendlyTime = (timeSinceStart: number) => {\n      let realTimeSinceStart = timeSinceStart / props.timeMultiplier;\n      let currentDate = new Date(props.startDate.getTime() + realTimeSinceStart * 1000);\n      let minutes = String(currentDate.getMinutes());\n      if (minutes.length < 2) {\n        minutes = '0' + minutes;\n      }\n      return currentDate.getDate() + '/' + (currentDate.getMonth() + 1) + '/' + currentDate.getFullYear() + ' ' + currentDate.getHours() + ':' + minutes;\n    }\n\n    if (props.startDate != null) {\n      const pTimestamp = Date.now() - props.timestampOffset;\n      const pLoopTime = props.loopTimeMinutes * 60 * 1000; // the loop time in milliseconds that deck gl displays\n\n      let timeThroughLoop = (pTimestamp % pLoopTime);\n      let pPercentThroughLoop = Math.floor((timeThroughLoop / pLoopTime) * 100);\n\n      // show time\n      let timeSinceStart = Math.floor(timeThroughLoop * (props.loopLength / pLoopTime));\n      let calculatedFriendlyTime = toFriendlyTime(timeSinceStart);\n\n      setFriendlyTime(calculatedFriendlyTime);\n      setPercentThroughLoop(pPercentThroughLoop);\n    }\n  }, [updateBoxInfoLoopToggle, props.timestampOffset, props.loopLength, props.loopTimeMinutes, props.startDate, props.timeMultiplier]);\n\n  // the loop time in milliseconds that deck gl displays\n  const getLoopTime = () => {\n    return props.loopTimeMinutes * 60 * 1000; // in x * 1000, x is in seconds\n  }\n\n  const handleTimeChange = (event: any) => {\n    const timestamp = Date.now() - props.timestampOffset;\n    const loopTime = getLoopTime();\n    let timeThroughLoop = (timestamp % loopTime);\n    let newPercentThroughLoop = event.target.value;\n    let newTimeThroughLoop = (newPercentThroughLoop / 100) * loopTime;\n    let newTimestampOffset = props.timestampOffset + (timeThroughLoop - newTimeThroughLoop);\n    handleTimestampOffset(newTimestampOffset);\n  }\n\n  const handleTrailLengthChange = (event: any) => {\n    let trailLengthStr = event.target.value;\n    if (trailLengthStr != null && trailLengthStr.length > 0) {\n      let pTrailLength = parseFloat(trailLengthStr);\n      if (pTrailLength <= 0) {\n        pTrailLength = 0.0001;\n      } else if (pTrailLength > 9999999) {\n        pTrailLength = 9999999;\n      }\n      handleTrailLength(pTrailLength);\n    } else {\n      handleTrailLength(props.appConfig.initialTrailLength);\n    }\n  }\n\n  const handleLoopTimeMinutesChange = (event: any) => {\n    let loopTimeMinutesStr = event.target.value;\n    if (loopTimeMinutesStr != null && loopTimeMinutesStr.length > 0) {\n      let pLoopTimeMinutes = parseFloat(loopTimeMinutesStr);\n      if (pLoopTimeMinutes <= 0) {\n        pLoopTimeMinutes = 0.0001;\n      } else if (pLoopTimeMinutes > 9999999) {\n        pLoopTimeMinutes = 9999999;\n      }\n      const timestamp = Date.now() - props.timestampOffset;\n      const loopTime = getLoopTime(); // the loop time in milliseconds that deck gl displays\n  \n      let newLoopTime = pLoopTimeMinutes * 60 * 1000; // in x * 1000, x is in seconds\n  \n      // Adjust the timestampOffset so that the new loop time kicks off at the same time as currently\n      let newTimestampOffset = props.timestampOffset \n        + ((timestamp % newLoopTime) - (newLoopTime * ((timestamp % loopTime) / loopTime)));\n      handleTimestampOffset(newTimestampOffset);\n  \n      handleLoopTimeMinutes(pLoopTimeMinutes);\n    } else {\n      handleLoopTimeMinutes(props.appConfig.initialLoopTimeMinutes);\n    }\n  }\n\n  const handleHighlightNodeChange = (highlightedNodesCommaSep: ValueType<any, any>) => {\n    if (highlightedNodesCommaSep == null) {\n      highlightedNodesCommaSep = [];\n    }\n    let pHighlightedNodes: string[] = highlightedNodesCommaSep.map((n: any) => n.value);\n    let highlightedNodesRemoved = props.highlightedNodes.length > pHighlightedNodes.length;\n    handleHighlightedNodes(pHighlightedNodes);\n    if (highlightedNodesRemoved) {\n      reloadTrips();\n    }\n  }\n\n  const handleDataSelectChange = (dataSampleOption: ValueType<any, any>) => {    \n    if (dataSampleOption != null) {\n      handleHighlightNodeChange([]);\n      handleDataChange(dataSampleOption.value as number);\n    }\n  }\n\n  const handleInfoBoxVisibility = (pHideInfoBox: boolean) => {\n    setHideInfoBox(pHideInfoBox);\n  }\n\n  const dataSampleOptions: any[] = props.appConfig.dataSamples.map((n: DataSampleUrls, idx: number) => { return { \"value\": idx, \"label\": n.title} });\n  const nodeListOptions: any[] = props.nodeList.map(n => { return { \"value\": n, \"label\": n} });\n  const highlightedNodesVl: any[] = props.highlightedNodes.map(n => { return { \"value\": n, \"label\": n} });\n\n  let selectDataEle = null;\n  if (props.appConfig.dataSamples.length > 1) {\n    selectDataEle = <div><h6>Select Data</h6><div><Select options={dataSampleOptions} onChange={handleDataSelectChange} value={dataSampleOptions[props.dataSampleIdx]} /></div></div>;\n  }\n\n  return (\n    <div id=\"top-left-container\">\n      <div id=\"title-box\"><h1>{props.friendlyName}</h1></div>\n      <div id=\"divinfo\" className={hideInfoBox ? \"hide\" : \"\"}>\n        <button id=\"btnHideInfoBox\" className=\"btn-transparent right-align\" onClick={() => handleInfoBoxVisibility(true)}>X</button>\n        {selectDataEle}\n        <h3>{friendlyTime}</h3>\n        <div>\n          <h6>Adjust point in time</h6>\n          <input className=\"full-width\" type=\"range\" min=\"0\" max=\"100\" value={String(percentThroughLoop)} onChange={handleTimeChange} />\n        </div>\n        <div>\n          <h6>Adjust loop time</h6>\n          <div className=\"block\">\n            <input className=\"\" type=\"number\" value={String(props.loopTimeMinutes)} onInput={handleLoopTimeMinutesChange} /><label>mins</label>\n          </div>\n        </div>\n        <div>\n          <h6>Adjust trail length</h6>\n          <div className=\"block\">\n            <input type=\"number\" value={String(props.trailLength)} onInput={handleTrailLengthChange} /><label>x</label>\n          </div>\n        </div>\n        <div>\n          <h6>Highlight Trips via {props.appConfig.nodeLabelPlural}</h6>\n          <div>\n            <Select\n              closeMenuOnSelect={false}\n              isMulti\n              options={nodeListOptions}\n              onChange={handleHighlightNodeChange}\n              onMenuClose={props.reloadTrips}\n              placeholder={\"Select \" + props.appConfig.nodeLabelPlural}\n              value={highlightedNodesVl}\n            />\n          </div>\n        </div>\n      </div>\n      <button id=\"btnShowInfoBox\" className={\"btn-transparent \" + (hideInfoBox ? \"\" : \"hide\")} onClick={() => handleInfoBoxVisibility(false)}>SHOW INFO BOX</button>\n    </div>\n  );\n}\n\nexport default InfoBox;","import * as React from 'react';\nimport './loader.css';\n\nexport default class Loader extends React.Component<any, any> {\n\n  render() {\n    return <div className=\"spinner-container\"><div className=\"spinner\">\n        <div className=\"spinner-circle spinner-circle-outer\"></div>\n        <div className=\"spinner-circle spinner-circle-inner\"></div>\n        <div className=\"spinner-circle spinner-circle-single-1\"></div>\n        <div className=\"spinner-circle spinner-circle-single-2\"></div>\n        <div className=\"text\">Loading</div>\n    </div></div>;\n  }\n}\n","import { KnownUrlParameters } from './data-interfaces';\n\nfunction getUrlParam(name: string): string {\n  let url = new URL(window.location.href);\n  let param = url.searchParams.get(name);\n  return param!;\n};\n\nfunction getNumber(numStr: string): number | null {\n  if (numStr != null) {\n    let numNum = Number(numStr);\n    if (!Number.isNaN(numNum)) {\n      return numNum;\n    }\n  }\n  return null;\n}\n\nconst PARAM_DATA_IDX = 'dataIdx';\nconst PARAM_LOOPTIME = 'loopTime';\nconst PARAM_TRAILLENGTH = 'trailLength';\nconst PARAM_HIGHLIGHTNODES = 'highlightNodes';\n\nfunction updateKeyInString(keysString: string, sParam: string, sValue: string): string {\n  let sURLVariables = keysString.length > 0 ? keysString.split('&') : [];\n  \n  let parameterUpdated = false;\n  for (let i = 0; i < sURLVariables.length; i++) {\n      let sParameterName = sURLVariables[i].split('=');\n\n      if (sParameterName[0] === sParam) {\n          sURLVariables[i] = sParam+'='+(sValue||'');\n          parameterUpdated = true;\n      }\n  }\n  if (parameterUpdated === false) {\n      sURLVariables.push(sParam+'='+(sValue||''));\n  }\n\n  return sURLVariables.join('&');\n}\n\nexport function getKnownUrlParameters(): KnownUrlParameters {\n  let result: KnownUrlParameters = {\n    dataSampleIdx: null,\n    loopTime: null,\n    trailLength: null,\n    highlightedNodes: null\n  };\n\n  // Convert day to dataUrlIdx\n  let dataIdx = getNumber(getUrlParam(PARAM_DATA_IDX));\n  if (dataIdx != null && dataIdx >= 0) {\n    result.dataSampleIdx = dataIdx;\n  }\n\n  // Validate loopTime\n  let loopTime = getNumber(getUrlParam(PARAM_LOOPTIME));\n  if (loopTime != null && loopTime > 0 && loopTime < 999999) {\n    result.loopTime = loopTime;\n  }\n\n  // Validate trailLength\n  let trailLength = getNumber(getUrlParam(PARAM_TRAILLENGTH));\n  if (trailLength != null && trailLength > 0 && trailLength < 999999) {\n    result.trailLength = trailLength;\n  }\n\n  // Validate highlightNode\n  let highlightNodes = getUrlParam(PARAM_HIGHLIGHTNODES);\n  if (highlightNodes != null && highlightNodes.length > 0) {\n    result.highlightedNodes = highlightNodes.split(',');\n  }\n\n  return result;\n}\n\nexport function updateUrlParameters(params: KnownUrlParameters) {\n  let newStateStr = decodeURIComponent(window.location.search.substring(1));\n  if (params.dataSampleIdx != null) {\n    newStateStr = updateKeyInString(newStateStr, PARAM_DATA_IDX, String(params.dataSampleIdx));\n  }\n  if (params.loopTime != null) {\n    newStateStr = updateKeyInString(newStateStr, PARAM_LOOPTIME, String(params.loopTime));\n  }\n  if (params.trailLength != null) {\n    newStateStr = updateKeyInString(newStateStr, PARAM_TRAILLENGTH, String(params.trailLength));\n  }\n  if (params.highlightedNodes != null) {\n    newStateStr = updateKeyInString(newStateStr, PARAM_HIGHLIGHTNODES, params.highlightedNodes.join(','));\n  }\n  \n  let queryFilters = \"?\" + newStateStr;\n  window.history.pushState({}, \"\", queryFilters);\n}","import { AppSettings } from \"./data-interfaces\";\n\nexport const DEFAULT_APP_SETTINGS: AppSettings = {\n    color: [255, 235, 86], // yellow\n    colors: [\n        [255, 109, 245], // pink\n        [0, 255, 119] // green\n    ],\n    dataSamples: [],\n    highlightColor: [255, 109, 245], // pink\n    initialLoopTimeMinutes: 1,\n    initialTrailLength: 100,\n    initialViewport: {\n        latitude: 19.045632,\n        longitude: 68.538902,\n        zoom: 3,\n        maxZoom: 20,\n        pitch: 45,\n        bearing: 0,\n        width: 500,\n        height: 500\n    },\n    mapboxStyle: \"mapbox://styles/mapbox/dark-v10\",\n    nodeLabel: \"Node\",\n    nodeLabelPlural: 'Nodes',\n    title: \"Trips\"\n};","import { useState, useEffect } from 'react';\nimport ReactMapGL, { Popup } from 'react-map-gl';\nimport {FlyToInterpolator} from 'deck.gl';\nimport DeckGLOverlay from './deckgl-overlay';\nimport InfoBox from './info-box';\nimport Loader from './loader';\nimport { AppSettings, KnownUrlParameters, Trip, TripContainer } from './data-interfaces';\nimport * as Utils from './utils';\nimport * as geojson from 'geojson';\nimport './app.css';\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport { DEFAULT_APP_SETTINGS } from './default-app-config';\n\nconst getWindowSize = () => {\n  return {\n    width: window.innerWidth,\n    height: window.innerHeight\n  };\n}\n\nconst App = () => {\n\n  const [knownUrlParams, setKnownUrlParams] = useState<KnownUrlParameters>(Utils.getKnownUrlParameters());\n  const [appSettings, setAppSettings] = useState<AppSettings>(DEFAULT_APP_SETTINGS);\n  const [dataSampleIdx, setDataSampleIdx] = useState(knownUrlParams.dataSampleIdx || -1);\n  const [friendlyName, setFriendlyName] = useState('');\n  const [highlightedNodes, setHighlightedNodes] = useState(knownUrlParams.highlightedNodes != null ? knownUrlParams.highlightedNodes : []);\n  const [loopLength, setLoopLength] = useState(1000);\n  const [loopTimeMinutes, setLoopTimeMinutes] = useState(knownUrlParams.loopTime || DEFAULT_APP_SETTINGS.initialLoopTimeMinutes);\n  const [nodeList, setNodeList] = useState<string[]>([]);\n  const [nodes, setNodes] = useState<geojson.FeatureCollection<geojson.Point> | null>(null);\n  const [popupInfo, setPopupInfo] = useState<any>(null);\n  const [startDate, setStartDate] = useState<Date>(new Date(2000, 1, 1, 0, 0, 0));\n  const [timestampOffset, setTimestampOffset] = useState<number>(Date.now());\n  const [timeMultiplier, setTimeMultiplier] = useState(1);\n  const [trailLength, setTrailLength] = useState(knownUrlParams.trailLength || DEFAULT_APP_SETTINGS.initialTrailLength);\n  const [trips, setTrips] = useState<Trip[] | null>(null);\n  const [viewport, setViewport] = useState({ \n    ...DEFAULT_APP_SETTINGS.initialViewport, \n    transitionDuration: 2000,\n    transitionInterpolator: new FlyToInterpolator() \n  });\n\n  const reloadTrips = () => {\n    // create a new array for trips so the colours are updated\n    setTrips((prevTrips) => { return prevTrips ? [...prevTrips] : prevTrips; });\n  }\n\n  const handleHighlightedNodes = (pHighlightedNodes: string[]) => {\n    setHighlightedNodes(pHighlightedNodes);\n    setKnownUrlParams((prevKnownUrlParams) => { return { ...prevKnownUrlParams, highlightedNodes: pHighlightedNodes }; });\n    setNodes((prevNodes) => { return prevNodes ? {...prevNodes} : prevNodes; });\n  }\n\n  const handleLoopTimeMinutes = (pLoopTimeMinutes: number) => {\n    setLoopTimeMinutes(pLoopTimeMinutes);\n    setKnownUrlParams((prevKnownUrlParams) => { return { ...prevKnownUrlParams, loopTime: pLoopTimeMinutes }; });\n  }\n\n  const handleOnHoverGeoPoint = (info: any) => {\n    setPopupInfo(info !== null ? info.object : null);\n  }\n\n  const handleTimestampOffset = (pTimestampOffset: number) => { setTimestampOffset(pTimestampOffset); }\n\n  const handleTrailLength = (pTrailLength: number) => {\n    setTrailLength(pTrailLength);\n    setKnownUrlParams((prevKnownUrlParams) => { return { ...prevKnownUrlParams, trailLength: pTrailLength }; });\n  }\n\n  const handleViewportChange = (pViewport: any) => {\n    setViewport((prevViewport) => { return { ...prevViewport, ...pViewport, ...getWindowSize() }; });\n  }\n\n  const handleDataChange = (pDataSampleIdx: number) => {\n    setDataSampleIdx(pDataSampleIdx);\n  }\n\n  useEffect(() => {\n    const loadAppSettings = () => {\n      fetch('app-settings.json', {\n        method: \"GET\",\n        headers: { \"Accept\": \"application/json; charset=utf-8\" }\n      }).then(function (fetchResponse) {\n        if (fetchResponse.status === 200) {\n          fetchResponse.json().then((pAppSettings: AppSettings) => {\n            setAppSettings((prevAppSettings) => { return { ...prevAppSettings, ...pAppSettings }; });\n          });\n        } else {\n          console.log('Sorry, could not load config (' + fetchResponse.status + ')');\n        }\n      }).catch(function (error) {\n        console.log(error);\n      });\n    };\n\n    const handleWindowResize = () => setViewport((prevViewport) => { return { ...prevViewport, ...getWindowSize() }; });\n    window.addEventListener('resize', handleWindowResize);\n\n    loadAppSettings();\n    return () => window.removeEventListener(\"resize\", handleWindowResize);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    setLoopTimeMinutes(knownUrlParams.loopTime || appSettings.initialLoopTimeMinutes);\n    setTrailLength(knownUrlParams.trailLength || appSettings.initialTrailLength);\n  }, [knownUrlParams, appSettings]);\n\n  useEffect(() => {\n    const loadTrips = (dataUrlIdx: number) => {\n      let url = appSettings.dataSamples[dataUrlIdx].tripsUrl;\n      fetch(url)\n        .then(function (fetchResponse) {\n          if (fetchResponse.status === 200) {\n            fetchResponse.json().then((response: TripContainer) => {\n              let pFriendlyName = appSettings.title;\n              if (response.friendlyName != null) {\n                pFriendlyName = response.friendlyName;\n              }\n              let pStartDate = Number(response.startTimestamp)\n                ? new Date(response.startTimestamp as number * 1000)\n                : new Date(Date.parse(response.startTimestamp as string));\n              let pTimeMultiplier = response.timeMultiplier;\n              let pTrips = response.trips;\n              let pLoopLength = response.loopLength;\n\n              // allocate colours if there's a small number of trips\n              if (pTrips.length > 0 && pTrips.length <= 10) {\n                for (let i = 0; i < pTrips.length; i++) {\n                  pTrips[i].color = appSettings.colors[i % appSettings.colors.length];\n                }\n              }\n\n              setStartDate(pStartDate);\n              setTimestampOffset(Date.now());\n              setFriendlyName(pFriendlyName);\n              setTrips(pTrips);\n              setLoopLength(pLoopLength);\n              setTimeMultiplier(pTimeMultiplier);\n            });\n          } else {\n            console.log('Something went wrong loading trips (' + fetchResponse.status + ')');\n          }\n        }).catch(function (error) {\n          console.log(error);\n        });\n    };\n\n    const loadNodeList = (dataUrlIdx: number) => {\n      fetch(appSettings.dataSamples[dataUrlIdx].nodeListUrl)\n        .then(function (fetchResponse) {\n          if (fetchResponse.status === 200) {\n            fetchResponse.json().then((response: string[]) => {\n              response.sort();\n              setNodeList(response);\n            });\n          } else {\n            console.log('Something went wrong loading node list (' + fetchResponse.status + ')');\n          }\n        }).catch(function (error) {\n          console.log(error);\n        });\n    };\n\n    const loadGeoJsonNodes = (dataUrlIdx: number) => {\n      fetch(appSettings.dataSamples[dataUrlIdx].geoJsonUrl)\n        .then(function (fetchResponse) {\n          if (fetchResponse.status === 200) {\n            fetchResponse.json().then((response: geojson.FeatureCollection<geojson.Point>) => {\n              setNodes(response);\n            });\n          } else {\n            console.log('Something went wrong loading GeoJSON nodes (' + fetchResponse.status + ')');\n          }\n        }).catch(function (error) {\n          console.log(error);\n        });\n    };\n\n    if (appSettings.dataSamples.length > 0) {\n      if (dataSampleIdx <= -1) {\n        setDataSampleIdx(0);\n      } else {\n        setKnownUrlParams((prevKnownUrlParams) => { return { ...prevKnownUrlParams, dataSampleIdx: dataSampleIdx }; });\n        setDataSampleIdx(dataSampleIdx);\n        loadTrips(dataSampleIdx);\n        loadNodeList(dataSampleIdx);\n        loadGeoJsonNodes(dataSampleIdx);\n        setViewport((prevViewport) => { return { ...prevViewport, ...appSettings.initialViewport, ...appSettings.dataSamples[dataSampleIdx].initialPartialViewport, ...getWindowSize() }; });\n      }\n    }\n  }, [dataSampleIdx, appSettings]);\n\n  useEffect(() => {\n    window.history.pushState({}, '', '');\n    Utils.updateUrlParameters(knownUrlParams);\n  }, [knownUrlParams]);\n\n  let loader = <span></span>;\n  if (trips == null) {\n    loader = <Loader />;\n  }\n\n  let popupEle = null;\n  if (popupInfo != null) {\n    popupEle =\n      <Popup longitude={popupInfo.geometry.coordinates[0]} latitude={popupInfo.geometry.coordinates[1]} closeButton={false} closeOnClick={false} anchor=\"bottom-left\">\n        <div className=\"popup-inner\">{appSettings.nodeLabel} {popupInfo.properties != null ? popupInfo.properties.name : ''}</div>\n      </Popup>;\n  }\n\n  return (\n    <div id=\"container\">\n      {loader}\n      <div id=\"divdeckgl\">\n        <ReactMapGL\n          {...viewport}\n          mapStyle={appSettings.mapboxStyle}\n          dragRotate={true}\n          onViewportChange={handleViewportChange}\n          mapboxApiAccessToken={process.env.REACT_APP_MAPBOX_TOKEN!}>\n          <DeckGLOverlay\n            color={appSettings.color}\n            handleOnHover={handleOnHoverGeoPoint}\n            highlightColor={appSettings.highlightColor}\n            highlightedNodes={highlightedNodes}\n            initialViewState={appSettings.initialViewport}\n            loopLength={loopLength}\n            loopTimeMinutes={loopTimeMinutes}\n            nodes={nodes!}\n            timestampOffset={timestampOffset}\n            trips={trips}\n            trailLength={trailLength}\n            viewport={viewport}\n          />\n          {popupEle}\n        </ReactMapGL>\n      </div>\n      <InfoBox\n        appConfig={appSettings}\n        dataSampleIdx={dataSampleIdx}\n        friendlyName={friendlyName}\n        handleDataChange={handleDataChange}\n        highlightedNodes={highlightedNodes}\n        handleHighlightedNodes={handleHighlightedNodes}\n        loopLength={loopLength}\n        loopTimeMinutes={loopTimeMinutes}\n        handleLoopTimeMinutes={handleLoopTimeMinutes}\n        nodeList={nodeList}\n        startDate={startDate}\n        timestampOffset={timestampOffset}\n        handleTimestampOffset={handleTimestampOffset}\n        timeMultiplier={timeMultiplier}\n        trailLength={trailLength}\n        handleTrailLength={handleTrailLength}\n        reloadTrips={reloadTrips}\n      />\n    </div>\n  );\n}\n\nexport default App;","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './app';\nimport reportWebVitals from './report-web-vitals';\n\n// Workaround: these 4 lines are to fix issue https://github.com/mapbox/mapbox-gl-js/issues/10565\n// Install packages worker-loader & mapbox-gl\nimport mapboxgl from \"mapbox-gl\";\n// eslint-disable-next-line import/no-webpack-loader-syntax\n(mapboxgl as any).workerClass = require('worker-loader!mapbox-gl/dist/mapbox-gl-csp-worker').default;\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}